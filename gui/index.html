<html>
	<body>	
		<script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js' type='text/javascript'></script>
		<script type="text/javascript" src="scripts/config.js"></script>
		<script>if (window.module) module = window.module;</script>

		<!-- Base of this is the streamlabs websocket sample code with some minor tweaks -->
		<script type = 'text/javascript'>			
			//Connect to socket
			const streamlabs = io(`https://sockets.streamlabs.com?token=` + socketToken);
			
			//Perform Action on event
			streamlabs.on('event', (eventData) => {
				if (!eventData.for || eventData.for === 'streamlabs' && eventData.type === 'donation') {
					//code to handle donation events
					console.log(eventData.message);
				}
				if (eventData.for === 'twitch_account') {
					switch(eventData.type) {
						case 'follow':
							//code to handle follow events
							console.log(eventData.message);
							$.post("http://localhost:8000/follow/", function(data, status){
								console.log("Express request: " + status);
							});
						break;
						case 'subscription':
							//code to handle subscription events
							console.log(eventData.message);
							$.post("http://localhost:8000/subscribe/", function(data, status){
								console.log("Express request: " + status);
							});
						break;
						default:
							//default case
							console.log(eventData.message);
					}
				}
			});
		</script>
	</body>
</html>